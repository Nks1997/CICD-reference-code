# ===================================================
# Kubernetes Services Example: ClusterIP, NodePort, LoadBalancer
# ===================================================

apiVersion: v1
kind: Service
metadata:
  name: my-clusterip-service
  labels:
    app: my-app
spec:
  selector:
    app: my-app
  ports:
    - port: 80
      targetPort: 80
  type: ClusterIP   # Internal access only

---
apiVersion: v1
kind: Service
metadata:
  name: my-nodeport-service
  labels:
    app: my-app
spec:
  selector:
    app: my-app
  type: NodePort     # External access via NodeIP:NodePort
  ports:
    - port: 80       # Cluster port
      targetPort: 80 # Pod container port
      nodePort: 30080 # External Node port (30000-32767)

---
apiVersion: v1
kind: Service
metadata:
  name: my-loadbalancer-service
  labels:
    app: my-app
spec:
  selector:
    app: my-app
  type: LoadBalancer  # Azure will provision an external IP
  ports:
    - port: 80          # Service port inside cluster
      targetPort: 80    # Container port
      protocol: TCP
# Important Annotations for AKS LoadBalancer:
  # service.beta.kubernetes.io/azure-load-balancer-internal: "true"
  #   - Makes the LB internal (private IP) instead of public
  # service.beta.kubernetes.io/azure-load-balancer-resource-group: "<rg-name>"
  #   - Use an existing Azure resource group for LB IP allocation
  # service.beta.kubernetes.io/azure-load-balancer-tcp-idle-timeout: "15"
  #   - Sets TCP idle timeout in minutes
  # service.beta.kubernetes.io/azure-load-balancer-health-probe-request-path: "/healthz"
  #   - Path used for LB health probe
